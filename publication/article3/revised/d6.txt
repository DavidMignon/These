Comparing pairwise-additive and many-body
Generalized Born models for acid/base calculations
and protein design
Francesco Villa, David Mignon, Savvas Polydorides, and Thomas
Simonson‚àó
Laboratoire de Biochimie (CNRS UMR7654), Department of Biology, Ecole
Polytechnique, 91128 Palaiseau, France.
‚àó
Email: thomas.simonson@polytechnique.fr

Abstract
Generalized Born (GB) solvent models are common in acid/base calculations and protein
design. With GB, the interaction between a pair of solute atoms depends on the shape
of the protein/solvent boundary and therefore the positions of all solute atoms, so that
GB is a many-body potential. For compute-intensive applications, the model is often
simplified further, by introducing a mean, native-like protein/solvent boundary, which
removes the many-body property. We propose a method for both acid/base calculations
and protein design that uses Monte Carlo simulations in which side chains can explore
rotamers, bind/release protons, or mutate. The solvent is treated with GB. The fluctuating protein/solvent dielectric boundary is treated in a way that is numerically exact
(within the GB framework), in contrast to a mean boundary. Its originality is that it
captures the many-body character while retaining the residue-pairwise complexity given
by a fixed boundary. The method is implemented in the Proteus protein design software.
It yields a slight but systematic improvement for acid/base constants in nine proteins
and a significant improvement for the computational design of three PDZ domains. It
eliminates a source of model uncertainty, which will facilitate the analysis of other model
limitations.
Key words: protein electrostatics, generalized Born model, Proteus program, molecular
mechanics, implicit solvent
1

1

Introduction

Continuum electrostatic treatments of aqueous solvent [1] are an important ingredient
of many biophysical models [2‚Äì5]. They describe a protein solute as a low dielectric
medium, embedded in a high dielectric solvent. Atomic charges within the protein are
shielded by the solvent, and the extent of shielding depends on the shape of the proteinsolvent boundary [6, 7]. As a result, the interaction between two protein atoms depends
on the position of the other protein atoms. Thus, to compute the forces and energy one
must solve a many-body problem [8‚Äì10].
Generalized Born (GB) models are simplified treatments that preserve much of the
physics of continuum electrostatics [11‚Äì13]. In particular, the GB interaction between two
protein atoms depends on their ‚Äúsolvation radii‚Äù, which approximate their distance from
solvent and depend on the positions of the other protein atoms [14‚Äì17]. In simulations, the
many-body nature of GB affects computational efficiency. Therefore, in some applications,
an additional approximation is introduced that makes the GB model ‚Äúpairwise additive‚Äù.
The GB energy then takes the form of a sum over pairs of solute atoms, similar to the
Coulomb and van der Waals energies. One way to do this is to assume the atomic solvation
radii are constant, and can be computed ahead of time using a consensus structure, such
as a crystal structure. With some GB variants, if the solvation radii are held constant,
the computational cost of a molecular dynamics simulation is divided by two.
Two applications that require very efficient energy calculations are acid/base calculations and computational protein design (CPD). CPD starts from a 3D structural model
and explores a vast space of sequences and conformations to identify protein variants
that have certain predefined properties, such as stability or ligand binding. Acid/base
properties of proteins are important for their structure, stability, and function [18, 19].
Acid/base calculations are related to CPD, since proton binding/unbinding to a side chain
can be treated formally as a kind of mutation. Indeed, pKa calculations have been used
recently to test CPD model and software packages [20‚Äì22].
Several recent models for CPD [23‚Äì31] and acid/base problems [32‚Äì44] combine atomistic simulations of the protein motions, a Poisson-Boltzmann (PB) or GB solvent, and a
Monte Carlo (MC) exploration of side chain mutations and/or protonation. In these models, the protein backbone is held fixed, and its motions described implicitly, through the
protein dielectric constant [45]. Side chains explore a discrete set of preferred rotamers,
so that conformational space is finite. The energy is approximated as a sum of pairwise

2

terms that involve just one or two amino acids; i.e., it is pairwise additive [31, 46‚Äì50].
With a discrete conformational space and a pairwise additive energy, interaction energies
can be computed ahead of time and stored in a lookup table, called the energy matrix.
Conformational space is then explored through a Monte Carlo simulation, which includes
side chain protonation changes and/or mutations.
The pairwise additivity approximation affects surface area calculations, but its main
effect is on the GB energy term [22, 50]. In previous work, to make the GB term pairwise
additive, we and others have assumed that for any given protein conformation, each amino
acid pair experiences a mean, effective dielectric environement that is native-like and
remains constant over time. We refer to this as the ‚ÄúNative Environment Approximation‚Äù,
or NEA. Such pairwise additivity approximations for the solvent are routine in CPD, and
are common for acid/base calculations [34, 51] and problems like protein:ligand docking
[52, 53]. We recently reported an extensive pKa benchmark test that used the NEA [22].
Here, we go beyond the NEA level of theory and apply a method proposed recently
that takes into account rigorously the dielectric environment of each amino acid and its
fluctuations over time [37, 54]. In other words, the method preserves the many-body
property of GB and continuum electrostatics. The originality of the method is that it
also preserves the pairwise complexity of the energy matrix and the MC calculation. We
refer to it as the ‚ÄúFluctuating Dielectric Boundary‚Äù method, or FDB. It exploits the fact
that with GB, the dielectric environment of a residue pair is completely characterized by
a small set of ‚Äúatomic solvation radii‚Äù. These radii are themselves pairwise sums over the
protein atoms [14, 16]. The method involves two steps. First, one computes an average
solvation radius BI for each residue I, that will be used for the calculation of residue‚Äì
residue interaction energies. This averaging leads to a GB variant we call ‚ÄúResidue-GB‚Äù
[54]. Second, one expresses the GB interaction energy of each residue pair I, J as a power
series relative to the BI , BJ . Since the residue solvation radii are themselves sums over
residue pairs, ones thus reduces the GB energy calculation to a pairwise complexity, as
was the case with NEA. The FDB method requires additional bookkeeping and overhead
during both the pre-calculation of the energy matrix and the MC simulation, leading to
an increased cost.
We have pursued three goals. First, we have implemented FDB in our CPD package
Proteus [31, 47, 55], with a gain in speed by a factor of two compared to our earlier
implementation [37] and a much friendlier and flexible interface. The overall cost increase,
compared to the NEA is about a factor of four, instead of eight previously. Second,

3

we have tested the method on a much larger set of acid/base constants, 149 instead of
78 previously. One of the proteins was hemoglobin, for which we also computed the
Bohr effect: the number of protons that bind when the protein switches from its deoxy
to its oxy form, which is of physiological interest [56, 57]. The FDB performance was
slightly but systematically better than NEA, with an rms deviation between the computed
and experimental pKa‚Äôs of 1.04 instead of 1.16 with NEA, a higher correlation with
experiment, fewer large errors, and an improved Bohr effect. The performance is not
as good as the empirical PropKa tool [58], nor as methods that use Poisson-Boltzmann
electrostatics instead of GB [34, 59]. However, it is comparable to PropKa for groups with
significantly shifted pKa ‚Äôs and it provides a more physically-transparent interpretation
than an empirical model.
Third, we used the new implementation to do protein design calculations with FDB
for three PDZ proteins, and compared it to the NEA. PDZ domains are small, globular domains of around 90 amino acids that establish protein-protein interaction networks in the
cell [60‚Äì65]. They were redesigned through MC simulations where all the amino acids (except Gly, Pro) were allowed to mutate freely. The simulations used a low and physicallyrealistic protein dielectric constant of four. The lowest-energy Proteus sequences were
compared to natural sequences from the Pfam database and to sequences generated by
the widely-used Rosetta package [23, 66‚Äì68]. The similarity between the Proteus and Pfam
sequences was comparable to the similarity between the Pfam sequences themselves. It
was also comparable to the Pfam similarity of sequences produced by Rosetta. Compared
to the NEA method, there was a significant improvement. Overall, the rigorous treatment
of GB and its many body character leads to improved quality for both sequence design
and acid/base constants; it eliminates a significant source of model uncertainty, and thus
facilitates the interpretation of the model predictions.

2
2.1

Computational methods
Fluctuating Dielectric Boundary method

The FDB method was proposed and tested earlier [37, 54]. For completeness, we recall
the main ideas. With GB, the electrostatic energy includes both a direct, Coulomb term

4

and a contribution from the solvent, polarized by the solute charges:
E elec = E Coul + ‚àÜGsolv
1 X q i qj 1 X
=
+
gij ,
2 i6=j rij
2 ij

(1)

where the sums are over all pairs of protein charges and the second sum includes diagonal
terms, i = j. The term gij represents a GB interaction or screening energy. In the most
common GB model [11], this term is approximated by
‚àí1/2
2
2
gij = g(ri , rj ) = œÑ qi qj rij
+ bi bj exp[‚àírij
/4bi bj ]
,

(2)

where œÑ = 1w ‚àí 1P , w is the solvent dielectric constant, P is the protein dielectric
constant and bi , bj are the solvation radii of the atoms i and j. The solvation radii are
approximated by a simple, analytical function of the positions of all the solute atoms: bi =
bi (r1 , r2 , ..., rN ). Different GB variants use different functional forms [11, 14‚Äì17, 69, 70].
The essential point is that in most variants, including the one considered here, the selfenergy takes the form of a sum over pairs of atoms.
With the FDB method, we modify the GB formulation to employ ‚Äúresidue‚Äù solvation radii, leading to a ‚ÄúResidue‚Äù GB model [54]. We define a self-energy contribution
corresponding to a particular residue pair I, J by the expression
X

self
EIJ
=

Eijself ,

(3)

i‚ààI,j‚ààJ

where the sum extends over atom pairs where i belongs to residue I and j to residue J.
The self-energy of residue I can be written
EIself =

X

self
EIJ

(4)

EIself .

(5)

J

and the total self-energy can be written
E self =

X
I

We then define the residue solvation radius BI by the relation
def

EIself = œÑ

X q2
i
.
2BI
i‚ààI

5

(6)

BI is a harmonic average over the bi , i ‚àà I, weighted by the squared charges.
We now define the contribution gIJ of residues I and J to the total screening energy
solv
‚àÜG :
X
‚àí1/2
2
2
/4BI BJ ]
(7)
+ BI BJ exp[‚àírij
gIJ =
œÑ qi qj rij
i‚ààI,j‚ààJ

For I = J, the double summation in Eq. (7) is actually restricted to pairs of distinct
atoms, i 6= j. For fixed interatomic distances rij , gIJ (BI BJ ) is a slowly varying function
of B ‚â° BI BJ . This dependency can be approximated by a low-order power expansion
[54]:
IJ
IJ 2
IJ ‚àí1/2
‚àí3/2
gIJ (B) ‚âà cIJ
+ cIJ
(8)
1 + c2 B + c3 B + c4 B
5 B
The coefficients cIJ
n can be pre-computed and stored in the energy matrix. To keep
the notations simple, their dependency on the particular rotamer combination rI , rJ is
not indicated explicitly. The quantities BI and BJ can be obtained from residue pair
contributions stored in the energy matrix. Thus, with (8), the Fluctuating Dielectric
Boundary method only involves quantities that depend on residue pairs.

2.2

FDB implementation details

For all the proteins except hemoglobin (Hb), all the residue pairs were treated using the
new, FDB method. For Hb, due to its size, the FDB method was applied to all pairs
belonging to one of the Hb subunits, say Œ±1 , and to interactions between Œ±1 residues and
other residues less than 6 AÃä away. For the other pairs, we used the NEA. For each FDB
residue pair and all possible rotamer combinations, the GB interaction energy was fitted
to the power expansion (8) in the range B=1‚Äì150 AÃä2 using our locally-modified version
of the Xplor program, which is itself part of the Proteus package [31]. The code was
based on the general linear fit subroutine LFIT from Numerical Recipes [54, 71]. The
fit is controlled at the level of the Xplor script language [72] by a statement of the form:
pick gbfit <selection1> <selection2>, which computes the GB interaction energy
between two groups of atoms R1, R2 defined by the two selections, which occupy a specific
conformation. The individual solvation radii of R1 and R2 are not computed from the
protein structure but are defined by the relation BR1 BR2 = B. Xplor performs the fit
and stores the fitting coefficients in the script variables $coef1, ..., $coef5, which can
be printed out by a script command, e.g., display $coef1. In the energy matrix, this
information is stored along with the other interaction energy terms. The contribution of

6

each residue pair to the GB self energy is also stored as a separate item in the energy
matrix. The matrix entry for a pair I, J and a particular rotamer combination rI , rJ is
shown in Fig. 1.
With the NEA method, at each step t of the Monte Carlo simulation, if a residue I
is displaced, the resulting energy change ‚àÜE(t) can be computed from energy matrix elements of the form EIJ . With FDB, the solvation radii change over time and so additional
operations are needed:
1. Throughout the trajectory, we maintain an up-to-date list of all the residue solvation
radii BI , whose values fluctuate over the trajectory. This is possible since the GB
self energy information is available in the matrix. At each MC step, BI is only
updated if a residue close to residue I (based on a neighbor list built ahead of time)
is displaced or mutated.
2. At each MC trial move, if a solvation radius BI changes, then residue I will contribute to the energy change ‚àÜE(t), since its GB interaction energies gIJ with all
other residues J are affected. In fact, the contributions to ‚àÜE(t) that result from
the change in BI are only computed for residues J within a certain cutoff distance
of I. These J values are read out of a second neighbor list, built ahead of time,
based on the size of the fitting coefficients cIJ
n (Eq. 8): small coefficients indicate
distant neighbors. For each neighbor J, the appropriate (rotamer-dependent) gIJ
value is obtained from the product BI BJ and the fitting coefficients cIJ
n , n = 1, ...,
5, via Eq. 8.
3. At regular intervals (about every 1000 MC steps), the entire energy and all the solvation radii are recomputed from scratch, to avoid propagation of numerical errors.
With these implementation choices, the FDB method is fairly efficient. For the
proteins BPTI, barnase, and lysozyme, using FDB for the entire protein, the total cost of
a full pH scan increases from about 0.5 hours with NEA to about two hours with FDB.
For Hb, the cost increase is much smaller because the matrix part dominates, and its cost
is almost the same with FDB and NEA. This is only a fraction of the cost of a naive
method using on-the-fly GB energy calculation.

7

2.3

Energy function and energy matrix

To describe each system, we used the Amber ff99SB force field [73, 74], combined with a
GB variant whose parameters were optimized earlier [46], that we call GB/HCT [14, 75].
The GB energy term is computed with either the NEA or the FDB method. For the
protein dielectric constant, we compared two values: 4 or 8. The solvent dielectric constant
was set to 80. The energy also included a solvent accessible surface area term [46, 48]. The
contact areas between each side chain pair, and between each side chain and the backbone
were computed by the Lee and Richards method [76], using a probe sphere of radius 1.5
AÃä. The atomic surfaces were multiplied by empirical atomic solvation parameters, which
describe the tendencies of various atom types to be buried or exposed, and were optimized
to give good results for the stability changes due to a large collection of point mutants
in various proteins: alkane = -5, polar = -8, ionic = -9, aromatic = -12, hydrogen = 0
(in cal/mol/AÃä2 ). Negative values indicate a preference to be solvent-exposed. To avoid
overcounting of surface burial, for residue pairs involving at least one buried side chain,
the surface energy was scaled by 0.65 [22, 46, 47, 50].
Interaction energies between all residue pairs in each protein were computed and
stored in an energy matrix, allowing for all their possible rotamers and protonation states.
The backbone was kept fixed as well as prolines and cysteines in disulfide bonds. In
addition, to alleviate bad steric contacts due to the rotamer approximation, each pair I,
J was energy-minimized through 30 conjugate-gradient steps, in the presence of the fixed
backbone and in the absence of the other side chains. During the pair minimization, each
side chain torsional angle was subjected to a flat-bottomed harmonic restraint with a
width of ¬±5‚ó¶ and a force constant of 200 kcal/mol/rad2 . The pair minimization was done
for each I, J rotamer combination (around 100 combinations per pair). Notice that the
other side chains contribute indirectly to the I ‚àíJ interaction energy, since they determine
the GB solvation radii of the pair, and thus its dielectric environment. With NEA, the
solvation radii of the pair (and rotamers) of interest are the ones computed ahead of time
with the rest of the protein occupying its native structure. With FDB, the GB interaction
of the I ‚àí J pair is not actually precomputed; rather, fitting coefficients cIJ
n and the GB
self interaction are precomputed and stored. The GB interaction will then be obtained
on-the-fly during the MC. Calculations were done with a locally-modified version of Xplor
[72], which is part of our in-house CPD package Proteus [31, 47].

8

2.4

Monte Carlo simulations at constant pH

The framework for constant-pH Monte Carlo has been described several times [22, 34,
37‚Äì40]. Proton binding is described within a classical mechanical, molecular mechanics
framework [2, 77‚Äì82]. The titrating protons are treated as classical mechanical particles,
bearing a partial charge [73]. We use a thermodynamic cycle [77], where the two horizontal
legs represent the protonation of a titratable residue in the protein environment and in
solution, respectively. In effect, when we remove a proton from the protein, we add it to
a corresponding model compound in solution. Thus, we obtain the shift ‚àÜpKa of each
):
residue‚Äôs pKa , compared to the model compound in solution (pKmodel
a
pKaprotein = pKamodel + ‚àÜpKa

(9)

‚àÜ‚àÜG‚ó¶ = ‚àÜG‚ó¶protein ‚àí ‚àÜG‚ó¶model
= ‚àí2.303 kT ‚àÜpKa

(10)

We can express the fraction x of the protonated species as a function of the standard
protonation free energy and the pH, through the well-known titration curve:
x=

1
1+

10(pH‚àípKa )

(11)

The pKa represents the pH at the inflection point of this curve.
The MC simulation starts from a random choice of protonation states and rotamers,
using the mt19937 random number generator from the GNU Software Library. At each
step, a move is chosen randomly and subjected to the Metropolis test [22, 83, 84]. Possible moves include changes of one or two rotamers, with or without an associated change
of the protonation state. Move selection probabilities were 0.42 (single rotamer change),
0.08 (single protonation change), 0.25 (two rotamer changes), and 0.25 (two protonation
changes). For two-position moves, the first position was chosen randomly and the second
was chosen among positions that had at least one conformation where the unsigned interaction with the first side chain was 3 kcal/mol or more. To determine the pKa ‚Äôs of all
titrating residues, we scanned a pH range from 0 to 15, in steps of 0.5 units. The MC run
at each pH value consisted of 10 million steps at room temperature (except myoglobin,
which used 20 million steps, properly sampled the behavior of a coupled side chain pair).
The quality of the MC sampling was tested for the deoxy form of HbA by performing
scans with 5, 10 and 20 million steps per pH value. These runs yielded pKa values within
0.2 units and Hill coefficients (see below) within 0.1.
9

2.5

Acid/base model compounds

Each titratable side chain has an associated model compound, which depends on the side
chain type X. Here, we use the molecule 2N-acetyl-1N-methyl-X-1-amide, which consists
of the backbone and side chain of X, capped with two blocking methyl groups [81]. X
can designate either the protonated or deprotonated side chain form. We consider the
titratable side chains Asp, non-disulfide Cys, Glu, His, Lys, and Tyr. The only titratable
Cys residues in our test proteins are in hemoglobin. Each titratable side chain is assigned
a ‚Äúreference‚Äù free energy, Gref
X , which represents the free energy of the model compound
in solution, estimated with the force field and including a pH-dependent term. The
important quantities are the differences between the two or three protonation states of
each model compound. These free energy differences can be expressed in the form:
ref
‚àÜGref
X = ‚àÜEX ‚àí kT ln

nXH
conf
+ Œ¥gX
‚àí 2.303 kT (pH ‚àí pKaX )
nX

(12)

ref
is the mean energy difference between the protonated and deprotonated states
Here, ‚àÜEX
of X, averaged over a Monte Carlo simulation; nXH and nX are the rotamer numbers of the
two states; pKX
a is the acid/base constant of the model compound, taken from experiment
conf
is the remaining free
[37, 85]; the rightmost term is the pH-dependent term, and Œ¥gX
energy. This term would be zero if all the rotamers of each protonation state had equal
energies and were equally populated. The pKX
a values were as follows: Asp, 3.9; Glu, 4.3;
Cys, 8.6; His, 6.5 (NŒ¥ form) or 7.0 (N form); Lys, 10.4; Tyr, 9.8. By construction, titrating
each model compound with Proteus using the reference free energies given by (12) should
conf
give back the experimental pKa . This condition determines the value of Œ¥gX
. Numerical
values were estimated by running a Monte Carlo simulation of each model compound
conf
with Proteus, at a pH equal to its experimental pKa and adjusting Œ¥gX
so that the two
protonation states were equally populated. The values are reported in Table 2.

2.6

Titration curves: fitting to the modified Hill equation

From each MC simulation, we computed the fractional occupancy xi of the protonated
state for each titrating site i at the given pH. After a full pH scan (300 million MC steps),
we obtained the titration curve xi (pH) of each group. Each curve was fitted to a sigmoidal
function, described by the modified Hill equation:
x=

[AH]
1
=
n(pH‚àípK
a)
+ [AH]
1 + 10

[A‚àí ]

10

(13)

The exponent n is called the Hill coefficient; it is proportional to the maximum slope of
the curve, which occurs at the inflection point. It is a measure of cooperativity, due to
multiple, interacting, titrating sites in the protein [86]. Values close to 1 indicate noncooperative proton binding. To determine the inflection point and the pKa , we used a
simple, iterative, grid search with focussing, implemented in a perl script. Both n and
pKa were chosen to minimize the mean square deviation between the fitted curve and
the MC populations x(pH). This led to unbiased estimates of the pKa ‚Äôs when fitting
to data generated by adding gaussian noise to the theoretical populations (13), using
Mathematica [87]. The standard deviations of the fitted pKa ‚Äôs (over 10000 noise samples)
were within 20% of that of the noise itself (0.1 or 0.05 pH units).

2.7

Protein setup for acid/base calculations

The test proteins are listed in Table 1. Staphylococcal nuclease (SNase) refers to a
hyperstable mutant known as ‚Äú‚àÜ+PHS‚Äù [88]. In most cases, the precise form of the
protein was the same in the pKa measurements and the X-ray structure, with all protein
atoms well-defined in the PDB coordinate file. N- and C-terminal groups were added
in all cases but three. For OMTKY3 and barnase, several atoms at the N-terminus are
disordered in the crystal structure and were omitted from our computational model, so
no N-terminal ammonium was added. For SNase, several residues at each terminus were
disordered, and so no N-terminal or C-terminal groups were added. Hydrogen atoms were
positioned with ideal stereochemistry using the Xplor hbuild commmand and subjected to
1000 steps of conjugate gradient minimization, with everything else kept fixed. Myglobin
has a heme cofactor, modeled using published force field parameters [89]. The proximal
His93, which coordinates the heme iron, was maintained in its deprotonated form and
kept in its crystal conformation.
Human adult Haemoglobin (Hb) is an (Œ±/Œ≤)2 tetramer formed of two Œ± and two Œ≤
subunits (141 and 146 residues, respectively). Each subunit binds a heme cofactor, to
which it is linked by a proximal histidine (Œ±His87; Œ≤His92). We considered two forms of
Hb; one has a CO molecule bound to the heme iron; this form is representative of oxy Hb.
The other, deoxy form has no bound oxygen or CO. Following Zheng et al [57], the atomic
coordinates were taken from the high resolution (1.25 AÃä) X-ray structures of the deoxy
(PDB 2DN2) and oxy forms (PDB 2DN3) [90]. The deoxy form was crystallized at T =
298 K, pH = 6.5 with ammonium sulfate and ammonium phosphate, and is thought [57] to
provide a good representation of the solution structure. The oxy form was crystallized at
11

T = 100 K, pH = 6.7, with sodium phosphate, potassium phosphate and glycerol. The rms
deviation between the oxy/deoxy crystal structures is 2.3 AÃä (nonhydrogen atoms). Crystal
waters were removed and hydrogens added. For each protein subunit, we established
covalent linkages between the N atom of the proximal histidine and the iron atom at the
heme center. Finally, the whole structure was subjected to 200 steps of Powell conjugate
gradient minimization, without any restraints. During this step, all ionizable residues were
assigned their standard protonation state (positive Lys; neutral Tyr, Cys, His; negative
Asp, Glu). Histidine residues were assigned to the NŒ¥ tautomer. The heme force field was
the same as for myoglobin.
Energy matrix calculations were done for the entire tetramer with NEA. With FDB,
two separate calculations were done, where either the Œ±1 or the Œ≤1 subunit was treated
with FDB, while the rest of the tetramer was treated with NEA. Although the heme
itself contains two propionate groups that can titrate, in principle, the force field does
not include a description of the protonated state, and rotamer libraries for the propionate groups are not available. Therefore, for simplicity, we kept the whole heme and the
proximal linked histidine fixed (like the backbone), with the propionates in their ionized,
deprotonated state. Because of this simplified model, we do not report the computed
titration behavior of nearby Œ±H45, since it donates a hydrogen bond to one of the heme
propionates. The experimental pKa reported for this histidine [91] may also be questionable. The reported uncertainty is large [57] and the value (5.25 in the deoxy state) is
downshifted with respect to the typical His range of ‚âà6.5; this appears inconsistent with
its short, 2.8 AÃä distance from the propionate oxygen in the crystal structures (2DN2,
2DN3), determined at a pH of 6.5.

2.8

The experimental pKa set

Table 1 indicates the number of titratable groups in each protein, and the number for
which experimental values are available. We consider acid/base changes for Asp, Cys,
Glu, His, Lys, and Tyr side chains. The only titratable Cys residues in our dataset are in
hemoglobin. In the simulations, we do not allow the chain termini to change protonation
states; they occupy the ionized state that is usual at neutral pH. For myoglobin, we
ignore the experimental pKa ‚Äôs reported for the His24‚ÄìHis119 pair, since these side chains
are closely coupled, sharing a proton over a broad pH range and their titration cannot
be described by two acid/base constants (three are needed [22]). This leaves us with 11
myoglobin side chains with experimental pKa values.
12

The four Hb subunits include 150 titratable groups in all: 44 lysines, 34 histidines,
30 aspartic acids, 24 glutamic acids, 12 tyrosines and 6 cysteines (not counting arginines,
C-, N- terminal groups, histidines that ligate the heme iron, or heme propionates). Only
for 13 of the histidines (and their 13 symmetry mates) are experimental values available,
both for oxy and deoxy Hb. They are located at the protein surface and their pKa values
were determined experimentally using proton NMR spectroscopy, at 29 ‚ó¶ C, with a 100
mM NaCl concentration [92]. One of them is Œ±H45, whose titration we do not predict (see
above). The other six histidines are buried. Œ±H87 and Œ≤H92 ligate the heme and cannot
be protonated. Two are ‚Äúdistal‚Äù to the heme, and close to the CO ligand: Œ±H58 and
Œ≤H63. The last two are Œ±H103 and Œ±H122, whose pKa values lie outside the experimental
pH range, pH = 4 to 9. Overall, for hemoglobin, we compare our predictions to 12 His
pKa ‚Äôs in two protein forms.

2.9

Bohr effect in hemoglobin

For hemoglobin, we compute the acid and alkaline Bohr effects; namely, the release of
protons upon oxygenation of the protein, at low or high pH. To compute the number ‚àÜHi
of protons released by side chain i upon oxygenation at a given pH, we subtract the deoxy
and oxy protonation probabilities:
1

‚àÜHi =
1 + 10

deoxy
pH‚àípKa,i

‚àí

1
1 + 10

oxy
pH‚àípKa,i

(14)

+ pKoxy
This function has a single peak at the position pH = (pKdeoxy
a,i
a,i )/2, whose height
is
10Œ¥i /2 ‚àí 1
‚àÜHi (peak) = Œ¥i /2
(15)
10
+1
deoxy
where Œ¥i = pKoxy
. Both Hb dimers contribute to the Bohr effect. While Hb
a,i - pKa,i
is symmetric in solution, there are differences between the dimers in the computed pKa
values, due to the crystal structures employed. With FDB, we only obtained pKa values
for one Œ± subunit and one Œ≤ subunit (see above); we assumed the other two subunits
had the same pKa values. For the NEA computations, oxy-Œ±2 H20 titrates outside the
simulated pH range; for the Bohr effect calculation, we assumed its pKa was the same as
that of oxy-Œ±1 H20.

13

2.10

Monte Carlo in sequence space

To generate designed PDZ sequences with Proteus, we perform a Monte Carlo simulation
where one copy of the folded protein is explicitly represented. The unfolded state is
included implicitly, by propagating the simulation with the energy function EM = Ef ‚àíEu ,
where Ef and Eu are the energies of the folded and unfolded states, respectively. The
structure of the unfolded form is not specified; the energy is assumed to be independent
of the particular unfolded structure, and to have the additive form:
Eu (S) =

n
X

Eu (ti )

(16)

i=1

where the sum is over the protein residues and Eu (ti ) is a free energy associated with
side chain type ti in the unfolded state. The Eu (t) values associated with each amino
acid type were optimized empirically, so that the simulations give an overall amino acid
composition that matches the natural PDZ domains in Pfam. The detailed empirical
optimization procedure is described elsewhere [93]; the resulting values are reported in
Table 3. The folded state energy is obtained from the energy matrix, precomputed as for
the acid/base calculations above. Residue pairs were minimized for 15 steps (instead of
30 for the acid/base calculations) and surface coefficients optimized for CPD were used
(Table 3). Calculations were done using either the NEA or the FDB method for the GB
solvent.
The simulations used a Replica Exchange MC procedure, where eight simulations
were run in parallel at different temperatures, and the instantaneous conformations were
exchanged randomly according to a Metropolis criterion [94]. Temperatures ranged from
0.125 to 2 kT units. Gly and Pro residues present in the wildtype protein were not allowed
to mutate, and positions that did mutate could not change into Gly or Pro. Simulations
were run for 750 million steps (per replica). The 10,000 lowest energy sequences and
conformations sampled by any replica were kept for analysis.

2.11

Rosetta sequence generation

Monte Carlo simulations were also done using version 2015.38.58158 of Rosetta (freely
available online) [23], using the command:
fixbb -s prot.pdb -resfile prot.res -nstruct 10000 -ex1 -ex2 -linmem_ig 10

where the ex1 and ex2 options activate an enhanced rotamer search for buried side chains,
14

the last option (linmem ig) corresponds to on-the-fly energy calculation, and default parameters were used otherwise. Gly and Pro residues present in the wildtype protein were
not allowed to mutate, and positions that did mutate could not change into Gly or Pro (as
with the Proteus design simulations). Simulations were run for each PDZ domain until
10,000 unique low energy sequences were identified, corresponding to run times of about
5 minutes per sequence on a single core of a recent Intel processor, for a total of 10 hours
(per protein) using 80 cores. This was comparable to the cost of the Proteus calculations
with NEA (energy matrix plus MC).

2.12

Designed sequence characterization

Designed sequences were compared to the Pfam alignment for the PDZ family, using
the Blosum40 scoring matrix and a gap penalty of -6. This matrix is appropriate for
comparing rather distant homologs (CPD and Pfam sequences in this case). Each Pfam
sequence was also compared to the Pfam alignment, which allowed for comparison between
the designed sequences and a typical pair of natural PDZ domains. The Pfam alignment
was the ‚ÄúRP55‚Äù alignment, consisting of 12,255 sequences. Similarities were computed
separately for 14 core residues and for the entire protein.
Designed sequences were submitted to the Superfamily library of Hidden Markov
Models [95, 96], which attempts to classify sequences according to the Structural Classification Of Proteins, or SCOP [97]. Classification was based on SCOP version 1.75
and version 3.5 of the Superfamily tools. Superfamily executes the hmmscan program,
which implements a Hidden Markov model for each SCOP family and superfamily. The
hmmscan program was executed using an E-value threshold of 10‚àí10 and a total of 15,438
models to represent the SCOP database.

3
3.1

Results
Acid/base performance for nine test proteins

We first describe the overall performance of the Native Environment Approximation
(NEA) and the Fluctuating Dielectric Boundary method (FDB) for nine test proteins
(Table 1). We performed pH scans from 0 to 15, to obtain the titration curves of all
ionizable sites and we fitted each curve to the modified Hill equation to obtain the pKa .
Calculations were done for a protein dielectric constant p = 4. We focus on the pKa
15

shifts relative to the appropriate model compound. The rms deviations from experimental values are reported in Table 4 for each protein and in Table 5 for each amino acid
type. Notice that some of the experimental measurements only provide an upper or a
lower bound for the pKa . In these cases (15 residues out of 149), if the computed value is
compatible with the bound, we consider the deviation to be zero. If the computed value
is outside the experimental interval, the deviation is computed with respect to the limit
of the interval that is closest to the computed value. This convention is consistent with
some previous pKa benchmark studies. The individual experimental and computed pKa
shifts are compared in Fig. 2.
The overall rms deviation from the experimental values is 1.04 with FDB and 1.16
with NEA. The mean unsigned errors are 0.8 (FDB) and 0.9 (NEA). The correlation
between computed and experimental pKa shifts is 0.7 with FDB and 0.6 with NEA. The
same average errors and the same FDB/NEA differences, within ¬±0.03, are obtained for
three random subsets of our test set. Thus, there is a small, but systematic improvement
with FDB. For each individual side chain i, we denote Œ¥Ei = EiNEA ‚àí EiNEA the difference
between the unsigned NEA and FDB pKa errors. If Œ¥Ei is positive, FDB gives a better
result than NEA, and vice versa. The large differences, |Œ¥Ei | > 1, are evenly distributed
between the two methods (5 positive and 5 negative values). The intermediate differences
are mostly in favor of FDB, with 37 Œ¥Ei values between 0.5 and 1, versus 12 between -1
and -0.5, and 20 Œ¥Ei values between 0.2 and 0.5, versus 15 between -0.5 and -0.2.
The largest individual FDB errors are 2.5 or 2.6 units for three residues; there are
four NEA errors that are larger (Table 4). The largest FDB errors occur for individual
Tyr, His, Asp, and Glu residues. On average, the largest rms deviations with FDB are
for Asp and Tyr (1.3 units); the largest rms deviations with NEA are for Asp and Glu.
FDB does better for all types except Tyr. Notice that FDB uses a single, mean solvation
radius BI for the side chain (residue-GB), which is a more significant approximation for
Tyr than for smaller side chains. Table 4 also reports mean errors obtained with the
empirical PropKa method [98, 99], which are smaller on average (overall rms deviation
from experiment of 0.8) than with FDB. The Null model, which assumes all pKa shifts
are zero, gives an rms deviation of 1.1, similar to FDB. For positions with large pKa shifts
(one unit or more), FDB does about as well as PropKa (Table 5), slightly better than
NEA, and much better than the Null model.
Illustrative titration curves are shown in Figure 3 for the OMTKY3 protein . The
numerical populations obtained from the MC simulations follow closely the theoretical,

16

sigmoidal curves, which is an indication of sampling quality. We also show the titration
behavior of a coupled histidine pair in myoglobin, His24 and His119, which bind a single
proton together at low pH, with the proton dividing its time between the two side chains
(Figure 3). This picture differs from the published interpretation of the NMR experiments,
where only a single pKa was reported and assigned entirely to His119 [100].

3.2

Performance and pKa error analysis for hemoglobin

With NEA, all titratable residues change their protonation state between pH = 0 and
15 except Œ±1 H45 in the deoxy form and Œ±2 H20, Œ±1 H58, Œ±2 H58, Œ≤1 H63, Œ≤2 H63, Œ±1 Y42,
Œ±1 K60, Œ±1 K61, Œ≤1 K66, Œ±2 E23, Œ±2 Y24, Œ±2 K56, Œ±2 K60, Œ±2 K61, Œ±2 C104, Œ≤2 K59 in the oxy
form. Small differences are seen between the two dimers. The mean unsigned difference
between the predicted pKa ‚Äôs of the two dimers is 0.3, with a few sizeable differences (5 of
more than 0.5 units, out of 30). Oxy-Œ±20 titrates in one dimer but not the other. Below,
we use the titrating His for our error statistics, excluding the non-titrating symmetry
mate.
Overall, the NEA method performs well. We achieved a good agreement with experiment for a large group of 24 histidines (two forms of Hb with 12 independent histidines
per tetramer), with an rms deviation of 0.9. The errors are similar to our previous study,
where 27 histidine pKa ‚Äôs in 12 proteins were predicted with an rms deviation of 1.0 using
p = 4 [22]. The individual computed and experimental pKa ‚Äôs are reported in Table 6.
The pKa shifts are compared to experiment in Fig. 4. The data set includes three residues
per Œ±/Œ≤ dimer with experimental pKa shifts of over 1 unit: Œ≤H97, Œ≤H143 and Œ≤H146. 10
of the 12 His residues (per Œ±/Œ≤ dimer) are predicted with the correct pKa shift direction
in the deoxy form, and 8 of 12 in the oxy form. The large pKa errors (unsigned errors of
0.7 or more) are all positive, meaning the positive His form is overstabilized.
The FDB model performs slightly better than NEA, with an overall rms deviation of
0.7 from experiment. Of the ten residues with NEA pKa errors of 0.7 or more, nine are
improved with FDB and one is slightly worse (oxy-Œ≤116, error increased from 1.9 to 2.1
units). The large errors are all positive, as with NEA. The experimental Hill coefficients
of the individual His titration curves are fairly well-reproduced, with an rms deviation of
0.3.

17

3.3

Bohr effect in hemoglobin

We consider next the acid and alkaline Bohr effects; namely, the release of protons from
Hb upon oxygenation of the protein, at low or high pH. To compute the number ‚àÜHi of
protons released by side chain i upon oxygenation at a given pH, we subtract the fractional
populations of the protonated state in the deoxy and oxy forms, Eq. (14). ‚àÜHi (pH) has
a single peak at pH(peak) = (pKdeoxy
+ pKoxy
a,i
a,i )/2. The peak height is
‚àÜHi (peak) =

ln 10
10Œ¥i /2 ‚àí 1
=
Œ¥i + O(Œ¥i2 )
Œ¥
/2
10 i + 1
4

(17)

2
where Œ¥i = pKdeoxy
- pKoxy
a,i
a,i and the rightmost form is a power expansion where O(Œ¥i ) is
of order Œ¥i2 . The peak has the same sign as Œ¥i , as expected; e.g., if pKdeoxy
is large and
a,i
oxy
pKa,i small (Œ¥i > 0), the group releases a proton upon oxygenation at an intermediate
pH (‚àÜHi (peak) > 0). The area of the peak is found to be Ai = Œ¥i .
From oxygenation measurements, there are a maximum of 1.96 protons released upon
oxygenation at pH = 7.1 (alkaline Bohr effect) and a maximum of 1.40 protons absorbed at
pH = 5.2 (acid Bohr effect) [91]. The total effect is well accounted for by the contributions
of the His side chains for which experimental pKa ‚Äôs are available. We focus on these 12
histidines (we exclude Œ±H45, which interacts closely with a titratable heme propionate;
see Methods). The individual His peaks are described in Table 7. The proton release
curve due to the 12 histidines is shown in Fig. 5, which includes the experimental, FDB
and NEA results. The experimental curve has a negative peak at pH = 5.2 (1.3 protons
absorbed) and a positive peak at pH = 7.1 (1.9 protons released). The FDB curve has
the alkaline peak at the correct position but with an overestimated height (2.9 protons
released). The overestimate is due to small errors (about 0.2‚Äì0.4 protons each) in four His
peaks (Œ±20, Œ±112, Œ≤77, Œ≤146), which are well within the mean error level of the individual
pKa ‚Äôs and the Œ¥i values. The computed pKa ‚Äôs are too high for Œ≤116 and Œ≤117 and the
peaks are too high, but the height errors have opposite signs and cancel out. The NEA
behavior is reported in Table 7 and Fig. 5. The alkaline peak height is somewhat better
than FDB but the peak is much too broad, extending down to the acid range and merging
with the acid peak to form a single broad peak.
At acidic pH, five histidines (excluding Œ±H45) have experimental peaks below pH =
6.5, absorbing a maximum of 1.3 protons. The acidic peak is absent from the FDB curve.
The main experimental contributors are Œ±89 (+0.61 protons), and Œ≤143 (-0.93 protons).
Œ±89 is well-reproduced by FDB (with a slight pH upshift), but Œ≤143 releases 0.36 protons.

18

Results with NEA are distinctly worse, with a signel broad positive peak extending down
to pH = 4. Overall, the main error in the Bohr effect with FDB is the lack of proton
absorption by Œ≤143 at acidic pH, due to small Œ≤143 pKa errors (0.3‚Äì0.5 units) in the oxy
and deoxy forms.

3.4

Complete redesign of three PDZ domains

Proteus design simulations used Replica Exchange Monte Carlo with eight replicas and
750 million steps per replica, at thermal energies kT that ranged from 0.125 to 2 kcal/mol.
All positions (except Gly and Pro) were allowed to mutate freely into all amino acid types
except Gly and Pro. The simulations were done with a protein dielectric constant of four.
The unfolded energies and surface energy coefficients employed are reported in Table 3.
The 10,000 sequences with the lowest energies among those sampled by any of the MC
replicas were retained for analysis, along with 10,000 sequences designed with Rosetta.
The sequences were analyzed by the Superfamily fold recognition tool [96, 101] (Table
8). For all three proteins, all 10,000 Rosetta sequences were classified as PDZ domains
by Superfamily. With Proteus and NEA, 98.7% of the sequences were classified as PDZ
domains. With the FDB method, there is a clear improvement, as all 10,000 of the Proteus
sequences were correctly classified, for all three proteins, with match lengths and E-values
that are significantly better than with NEA, and comparable to Rosetta.
Fig. 6 shows the Blosum40 similarity scores between designed and natural sequences,
for each PDZ protein, both for core positions and the entire protein. With Rosetta, the designed sequences have scores that are similar to the Pfam sequences themselves, especially
for the core positions. With Proteus and the NEA, the similarities for the protein core
are excellent, as observed previously [93]. In the core, we are far from the protein/solvent
boundary so that an approximate NEA treatment is not damaging. For the entire protein, the overlap with Pfam scores is less good, especially for the NHERF case, where the
Proteus sequences overlap with the bottom of the peak of natural scores. Switching to the
FDB method, there is a slight decrease for syntenin in the overall similarity to Pfam, and
a significant decrease for the core residues. For DLG2, there is a significant improvement
with FDB and for NHERF, there is a very large improvement, about 50 Blosum points.
For all three proteins, the overall similarities with FDB overlap with the lower half of the
Pfam peak and are close to the Rosetta similarities, a significant improvement over NEA.

19

4

Concluding discussion

Simple continuum dielectric models are important tools to understand and engineer electrostatic interactions in proteins. Some variants use a fixed protein conformation, while
others use an all-atom molecular dynamics exploration of protein conformations. The
present variant is in between, with a fixed protein backbone but explicit exploration of
side chain rotamers. This level of detail is common in protein design applications, but
less so for acid/base applications, especially in combination with a GB solvent model.
With this level of detail, the protein/solvent dielectric boundary fluctuates over time due
to thermal motion and reorganization in response to protonation changes. In previous
studies, these dielectric shape fluctuations were neglected, and a mean, effective dielectric
boundary was used instead. Here, we have applied and tested an improved variant, where
the protein shape is rigorously accounted for in the GB interaction energies at all times.
In this way, we achieved several goals.
Our first goal was to implement the more rigorous GB method within the Proteus
software and model framework. This framework uses a precalculated energy matrix to
allow very efficient Monte Carlo simulations of proteins, where rotamers, protonation
states, and side chain types can all vary [45, 94]. The present implementation is about
four times as costly as the NEA method; its cost is reduced by half compared to an earlier
FDB implementation [37]. The present implementation is also much friendlier and more
flexible than the earlier one. It makes it straightforward to use FDB in CPD, and to use
FDB for some residue pairs and NEA for others, further reducing the cost.
A second goal was to verify that the more rigorous FDB method leads to more accurate acid/base and protein design calculations, which is indeed the case. We observed a
small but significant improvement for acid/base constants in nine proteins. The rms error
and correlation with experiment improved and there were fewer large errors, compared to
NEA. The rms error with FDB was 1.0 for the present test set, the mean unsigned error
was 0.8, and the performance for residues with large pKa shifts was rather good. The
performance was not as good as some more empirical models, such as PropKa or Rosetta
[21] or the simplest PB models, which employ a large protein dielectric constant (20 or
more) and therefore behave much more like the Null model [57, 102]. Better performance
was also obtained recently using PB with a lower protein dielectric of 8, along with a
smoothed protein/solvent boundary and inclusion of ionic strength [59], which led to an
rms error of 0.81 for the proteins studied here (other than Hb). The use of PB, ionic

20

strength, and a smoothed boundary are all steps towards increased realism. However,
a dielectric value of eight is still 2-3 times larger than the value measured for protein
powders and acetamide crystals or computed from the atomic fluctuations of the internal regions of several proteins [4, 103]. It is inconsistent with the use of atomic charges
optimized for MD simulations that employ a protein dielectric of one [104, 105] and, for
related reasons, it gives an incorrect decomposition of elecrostatic free energies into reorganization and static components, as discussed at length earlier [104, 105]. Therefore,
models with lower, more physical dielectric values for the protein interior are important.
Here, good performance was obtained with a dielectric value P =4 that is closer to the
experimental one, and accounts for the protein‚Äôs electronic polarizability and the motions
of the protein backbone [106]. Notice that errors introduced by the NEA method tend
to scale with the inverse of the protein dielectric constant [22, 50], so that studies with a
low P can be done with much more confidence using FDB instead of NEA.
There was also a distinct improvement with FDB for the design of three PDZ domains.
There was a slight performance decrease for syntenin, compared to NEA, but a significant
improvement for DLG2 and a very large improvement for NHREF. Fold recognition tests
with the Superfamily library of Hidden Markov Models gave better results for all three
proteins using FDB. The good design results were obtained with a protein dielectric of
four, in contrast to earlier work with NEA where a larger value of eight worked best [93].
Several aspects of the model could be analyzed and improved further. PB might give
improved performance, although more direct comparisons between GB and PB are needed
to clarify this question. Treatment of ionic strength might also improve performance
within the GB framework [22, 107]. The GB parameters and surface energy coefficients
could also be optimized further, since previous parameterization did not use ‚ÄúResidue
GB‚Äù [46]. The structural model could perhaps be improved by including several backbone
conformations, for example by extracting models from a molecular dynamics simulation.
Monte Carlo hops between backbone conformations could then be combined with rotamer
and protonation or mutation moves [108].
By eliminating one source of uncertainty and error in our MC method, we expect
to obtain not only increased accuracy but an improved understanding of other sources
of error. The method described here can be used as a complement to fast, empirical
acid/base predictors like PropKa, since the cost of a full titration scan is about two hours
on a small computer cluster. While this is far more expensive than PropKa, it is still
fast enough to perform as a routine, preliminary analysis of a protein of interest. Since

21

the performance for large pKa shifts is similar to PropKa, our method can provide a
useful additional check for such residues. Finally, by implementing FDB in our protein
design software Proteus, we improved the design performance and also make it easier
to perform protein design applications that combine changes in protonation states with
side chain mutations. Protonation changes can also be modelled in combination with the
binding/unbinding of a ligand [109], two processes that are often coupled [19, 110].

Acknowledgements
We thank Martin Karplus, Michael Schaefer and Guishan Zheng for helpful discussions
and for communicating unpublished data. This work was partly supported by the Agence
Nationale de la Recherche (ProtiCAD project).

References
[1] FroÃàhlich, H. Theory of Dielectrics. Clarendon Press, Oxford, 1949.
[2] Schaefer, M., van Vlijmen, H. W. T., and Karplus, M. Electrostatic contributions
to molecular free energies in solution. Adv. Prot. Chem. 51 (1998), 1‚Äì57.
[3] Kollman, P. A., Massova, I., Reyes, C., Kuhn, B., Huo, S., Chong, L., Lee, M.,
Lee, T., Duan, Y., Wang, W., Donini, O., Cieplak, P., Srinivasan, J., Case,
D. A., and Cheatham, T. E. Calculating structures and free energies of complex
molecules: combining molecular mechanics and continuum models. Acc. Chem. Res. 33
(2000), 889‚Äì897.
[4] Simonson, T. Electrostatics and dynamics of proteins. Rep. Prog. Phys. 66 (2003),
737‚Äì787.
[5] Baker, N. A. Biomolecular applications of Poisson-Boltzmann methods. Rev. Comp.
Chem. 21 (2005), 349‚Äì379.
[6] Shaw, P. Theory of the Poisson Green‚Äôs function for discontinuous dielectric media with
an application to protein biophysics. Phys. Rev. A 32 (1985), 2476‚Äì2487.
[7] Zauhar, R., and Morgan, R. A new method for computing the macromolecular electric
potential. J. Mol. Biol. 186 (1985), 815.

22

[8] Schaefer, M., and Froemmel, C. A precise analytical method for calculating the
electrostatic energy of macromolecules in aqueous solution. J. Mol. Biol. 216 (1990),
1045‚Äì1066.
[9] Gilson, M., Davis, M., Luty, B., and McCammon, J. A. Computation of electrostatic forces on solvated molecules using the Poisson-Boltzmann equation. J. Phys. Chem.
97 (1993), 3591‚Äì3600.
[10] Im, W., Beglov, D., and Roux, B. Continuum solvation model: computation of
electrostatic forces from numerical solutions to the Poisson-Boltzmann equation. Comp.
Phys. Comm. 111 (1998), 59‚Äì75.
[11] Still, W. C., Tempczyk, A., Hawley, R., and Hendrickson, T. Semianalytical
treatment of solvation for molecular mechanics and dynamics. J. Am. Chem. Soc. 112
(1990), 6127‚Äì6129.
[12] Bashford, D., and Case, D. Generalized Born models of macromolecular solvation
effects. Ann. Rev. Phys. Chem. 51 (2000), 129‚Äì152.
[13] Feig, M., Onufriev, A., Lee, M. S., Im, W., Case, D. A., and Brooks III, C. L.
Performance comparison of generalized Born and Poisson methods in the calculation of
electrostatic solvation energies for protein structures. J. Comput. Chem. 25 (2004), 265‚Äì
284.
[14] Hawkins, G. D., Cramer, C., and Truhlar, D. Pairwise descreening of solute charges
from a dielectric medium. Chem. Phys. Lett. 246 (1995), 122‚Äì129.
[15] Qiu, D., Shenkin, P. S., Hollinger, F. P., and Still, W. C. The GB/SA continuum
model for solvation. A fast analytical method for the calculation of approximate Born radii.
J. Phys. Chem. A 101 (1997), 3005‚Äì3014.
[16] Schaefer, M., and Karplus, M. A comprehensive analytical treatment of continuum
electrostatics. J. Phys. Chem. 100 (1996), 1578‚Äì1599.
[17] Lee, M. S., Salsbury Jr., F. R., and Brooks III, C. L. Novel generalized Born
methods. J. Chem. Phys. 116 (2002), 10606‚Äì10614.
[18] Fersht, A. Structure and mechanism in protein science: a guide to enzyme catalysis and
protein folding. Freeman, New York, 1999.

23

[19] Onufriev, A. V., and Alexov, E. Protonation and pKa changes in protein-ligand
binding. Quart. Rev. Biophys. 46 (2013), 181‚Äì209.
[20] Barth, P., Alber, T., and Harbury, P. B. Accurate, conformation-dependent predictions of solvent effects on protein ionization constants. Proc. Natl. Acad. Sci. USA 104
(2007), 4898‚Äì4903.
[21] Kilambi, K., and Gray, J. J. Rapid calculation of protein pKa values using Rosetta.
Biophys. J. 103 (2012), 587‚Äì595.
[22] Polydorides, S., and Simonson, T. Monte Carlo simulations of proteins at constant
pH with generalized Born solvent, flexible sidechains, and an effective dielectric boundary.
J. Comput. Chem. 34 (2013), 2742‚Äì2756.
[23] Baker, D. Prediction and design of macromolecular structures and interactions. Phil.
Trans. R. Soc. Lond. 361 (2006), 459‚Äì463.
[24] Butterfoss, G. L., and Kuhlman, B. Computer-based design of novel protein structures. Ann. Rev. Biophys. Biomolec. Struct. 35 (2006), 49‚Äì65.
[25] GueÃÅrois, R., and Lopez de la Paz, M., Eds. Protein Design: Methods And Applications. Humana Press, 2007.
[26] Lippow, S. M., and Tidor, B. Progress in computational protein design. Curr. Opin.
Biotech. 18 (2007), 305‚Äì311.
[27] Pleiss, J. Protein design in synthetic biology. Curr. Opin. Biotech. 22 (2011), 611‚Äì617.
[28] Pantazes, R. J., Greenwood, M. J., and Maranas, C. D. Recent advances in
computational protein design. Curr. Opin. Struct. Biol. 21 (2011), 467‚Äì472.
[29] Saven, J. G. Computational protein design: engineering molecular diversity, nonnatural
enzymes, nonbiological cofactor complexes, and membrane proteins. Curr. Opin. Chem.
Biol. 15 (2011), 452‚Äì457.
[30] Samish, I., MacDermaid, C. M., Perez-Aguilar, J. M., and Saven, J. G. Theoretical and computational protein design. Ann. Rev. Phys. Chem. 62 (2011), 129‚Äì‚Äì149.
[31] Simonson, T. Protein:ligand recognition: simple models for electrostatic effects. Curr.
Pharma. Design 19 (2013), 4241‚Äì4256.

24

[32] You, T., and Bashford, D. Conformation and hydrogen ion titration of proteins:
a continuum electrostatic model with conformational flexibility. Biophys. J. 69 (1995),
1721‚Äì1733.
[33] Beroza, P., and Case, D. A. Including side chain flexibility in continuum electrostatic
calculations of protein titration. J. Phys. Chem. 100 (1996), 20156‚Äì20163.
[34] Georgescu, E. R., Alexov, E., and Gunner, M. Combining conformational flexibility and continuum electrostatics for calculating pKa ‚Äôs in proteins. Biophys. J. 83 (2002),
1731‚Äì1748.
[35] Kim, J., Mao, J., and Gunner, M. Are acidic and basic groups in buried proteins
predicted to be ionized? J. Mol. Biol. 348 (2005), 1283‚Äì1298.
[36] Song, Y., Mao, J., and Gunner, M. R. MCCE2: improving protein pKa calculations
with extensive side chain rotamer sampling. J. Comput. Chem. 30 (2009), 2231‚Äì2247.
[37] Aleksandrov, A., Polydorides, S., Archontis, G., and Simonson, T. Predicting
the acid/base behavior of proteins: A constant-pH Monte Carlo approach with Generalized
Born solvent. J. Phys. Chem. B 114 (2010), 10634‚Äì10648.
[38] Baptista, A. M., Martel, P. J., and Petersen, S. B. Simulation of protein conformational freedom as a function of pH: constant-pH molecular dynamics using implicit
titration. Proteins 27 (1997), 523‚Äì544.
[39] Lee, M. S., Salsbury Jr., F. R., and Brooks III, C. L. Constant pH molecular
dynamics using continuous titration coordinates. Proteins 56 (2004), 738‚Äì752.
[40] Mongan, J., Case, D. A., and McCammon, J. A. Constant pH molecular dynamics
in generalized Born implicit solvent. J. Comput. Chem. 25 (2004), 2038‚Äì2048.
[41] Khandogin, J., and Brooks, C. L. Toward the accurate first-principles prediction of
ionization equilibria in proteins. Biochemistry 45 (2006), 9363‚Äì9373.
[42] Machuqueiro, M., and Baptista, A. M. Acidic range titration of HEWL using a
constant-pH molecular dynamics method. Proteins 72 (2008), 289‚Äì298.
[43] Wallace, J. A., and Shen, J. K. Predicting pKa values with constant-pH molecular
dynamics. Methods Enzym. 466 (2009), 455‚Äì475.

25

[44] Arthur, E. J., Yesselman, J. D., and Brooks, C. L. Predicting extreme pKa shifts
in Staphylococcal nuclease mutants with constant pH molecular dynamics. Proteins 79
(2011), 3276‚Äì3286.
[45] Simonson, T., Gaillard, T., Mignon, D., Schmidt am Busch, M., Lopes, A.,
Amara, N., Polydorides, S., Sedano, A., and Archontis, K. D. G. Computational
protein design: the Proteus software and selected applications. J. Comput. Chem. 34
(2013), 2472‚Äì2484.
[46] Lopes, A., Aleksandrov, A., Bathelt, C., Archontis, G., and Simonson, T.
Computational sidechain placement and protein mutagenesis with implicit solvent models.
Proteins 67 (2007), 853‚Äì867.
[47] Schmidt am Busch, M., Lopes, A., Mignon, D., and Simonson, T. Computational
protein design: software implementation, parameter optimization, and performance of a
simple model. J. Comput. Chem. 29 (2008), 1092‚Äì1102.
[48] Schmidt am Busch, M., Lopes, A., Amara, N., Bathelt, C., and Simonson, T.
Testing the Coulomb/Accessible Surface Area solvent model for protein stability, ligand
binding, and protein design. BMC Bioinformatics 9 (2008), 148‚Äì163.
[49] Polydorides, S., Amara, N., Aubard, C., Plateau, P., Simonson, T., and Archontis, G. Computational protein design with a generalized Born solvent model: application to asparaginyl-tRNA synthetase. Proteins 79 (2011), 3448‚Äì3468.
[50] Gaillard, T., and Simonson, T. Pairwise decomposition of an MMGBSA energy
function for computational protein design. J. Comput. Chem. 35 (2014), 1371‚Äì1387.
[51] Gunner, M., Zhu, X., and Klein, M. C. MCCE analysis of the pKa ‚Äôs of introduced
buried acids and bases in Staphylococcal nuclease. Proteins 79 (2011), 3306‚Äì3319.
[52] Majeux, N., Scarsi, M., and Caflisch, A. Efficient electrostatic solvation model for
protein‚Äìfragment docking. Proteins 42 (2000), 256‚Äì268.
[53] Ruvinsky, A. M. Role of binding entropy in the refinement of protein-ligand docking
predictions: Analysis based on the use of 11 scoring functions. J. Comput. Chem. 8 (2007),
1364‚Äì1372.
[54] Archontis, G., and Simonson, T. A residue-pairwise Generalized Born scheme suitable
for protein design calculations. J. Phys. Chem. B 109 (2005), 22667‚Äì22673.

26

[55] Polydorides, S., Michael, E., Mignon, D., Druart, K., Archontis, G., and
Simonson, T. Proteus and the design of ligand binding sites. In Methods in Molecular
Biology: Design and Creation of Protein Ligand Binding Proteins, B. Stoddard, Ed.,
vol. 1414. Springer Verlag, New York, 2016, p. 0000.
[56] Perutz, M. Mechanisms of cooperativity and allosteric regulation in proteins. Cambridge
University Press, Cambridge, 1990.
[57] Zheng, G., Schaefer, M., and Karplus, M. Hemoglobin Bohr effects: Atomic origin
of the histidine residue contributions. Biochemistry 52 (2013), 8539‚Äì8555.
[58] Olsson, M. H. M., Sondergaard, C. R., Rostowski, M., and Jensen, J. H.
PROPKA3: consistent treatment of internal and surface residues in empirical pKa predictions. J. Chem. Theory Comput. 7 (2011), 525‚Äì537.
[59] Wang, L., Li, L., and Alexov, E. pKa predictions for proteins, RNAs, and DNAs
with the Gaussian dielectric function using DelPhi pKa . Proteins 83 (2015), 2186‚Äì2197.
[60] Harris, B. Z., and Lim, W. A. Mechanism and role of PDZ domains in signaling
complex assembly. J. Cell Sci. 114 (2001), 3219‚Äì3231.
[61] Hung, A. Y., and Sheng, M. PDZ domains: Structural modules for protein complex
assembly. J. Biol. Chem. 277 (2002), 5699‚Äì5702.
[62] Tonikian, R., Zhang, Y. N., Sazinsky, S. L., Currell, B., Yeh, J. H., Reva,
B., Held, H. A., Appleton, B. A., Evangelista, M., Wu, Y., Xin, X. F., Chan,
A. C., Seshagiri, S., Lasky, L. A., Sander, C., Boone, C., Bader, G. D., and
Sidhu, S. S. A specificity map for the PDZ domain family. PLoS Biology 6 (2008),
2043‚Äì2059.
[63] Gfeller, D., Butty, F., Wierzbicka, M., Verschueren, E., Vanhee, P., Huang,
H., Ernst, A., Darand, N., Stagljar, I., Serrano, L., Sidhu, S. S., Bader, G. D.,
, and Kim, P. M. The multiple-specificity landscape of modular peptide recognition
domains. Molec. Syst. Biol. 7 (2011), art. 484.
[64] Subbaiah, V. K., Kranjec, C., Thomas, M., and Ban, L. Structural and thermodynamic analysis of PDZ-ligand interactions. Biochem. J. 439 (2011), 195‚Äì205.
[65] Shepherd, T. R., and Fuentes, E. J. Structural and thermodynamic analysis of
PDZ-ligand interactions. Methods in Enzymology 488 (2011), 81‚Äì100.

27

[66] Kuhlman, B., and Baker, D. Native protein sequences are close to optimal for their
structures. Proc. Natl. Acad. Sci. USA 97 (2000), 10383‚Äì10388.
[67] Dantas, G., Kuhlman, B., Callender, D., Wong, M., and Baker, D. A large
test of computational protein design: Folding and stability of nine completely redesigned
globular proteins. J. Mol. Biol. 332 (2003), 449‚Äì460.
[68] Rohl, C. A., Strauss, C. E. M., S., M. K. M., and Baker, D. Protein structure
prediction using Rosetta. Methods Enzym. 383 (2004), 10383‚Äì1038866‚Äì93.
[69] Ghosh, A., Rapp, C., and Friesner, R. A. Generalized Born model based on a surface
area formulation. J. Phys. Chem. B 102 (1998), 10983‚Äì10990.
[70] Onufriev, A. V., Bashford, D., and Case, D. A. Effective Born radii in the generalized Born approximation: The importance of being perfect. J. Comput. Chem. 23 (2002),
1297‚Äì1304.
[71] Press, W., Flannery, B., Teukolsky, S., and Vetterling, W. Numerical Recipes.
Cambridge University Press, Cambridge, 1986.
[72] BruÃànger, A. T. X-plor version 3.1, A System for X-ray crystallography and NMR.
Yale University Press, New Haven, 1992.
[73] Cornell, W., Cieplak, P., Bayly, C., Gould, I., Merz, K., Ferguson, D.,
Spellmeyer, D., Fox, T., Caldwell, J., and Kollman, P. A second generation
force field for the simulation of proteins, nucleic acids, and organic molecules. J. Am.
Chem. Soc. 117 (1995), 5179‚Äì5197.
[74] Ponder, J., and Case, D. A. Force fields for protein simulations. Adv. Prot. Chem. 66
(2003), 27.
[75] Moulinier, L., Case, D. A., and Simonson, T. Xray structure refinement of proteins
with the generalized Born solvent model. Acta Cryst. D 59 (2003), 2094‚Äì2103.
[76] Richards, F. M. Areas, volumes, packing, and protein structure. Ann. Rev. Biophys.
Bioeng. 6 (1977), 151‚Äì175.
[77] Warshel, A., Sussman, F., and King, G. Free energy changes in solvated proteins:
microscopic calculations using a reversible charging process. Biochemistry 25 (1986),
8368‚Äì8372.

28

[78] Bashford, D., and Karplus, M. The pKa ‚Äôs of ionizable groups in proteins: atomic
detail from a continuum electrostatic model. Biochemistry 29 (1990), 10219‚Äì10225.
[79] Antosiewicz, J., McCammon, J. A., and Gilson, M. Prediction of pH dependent
properties of proteins. J. Mol. Biol. 238 (1994), 415‚Äì436.
[80] Sham, Y. Y., Muegge, I., and Warshel, A. The effect of protein relaxation on
charge‚Äìcharge interactions and dielectric constants of proteins. Biophys. J. 74 (1998),
1744‚Äì1753.
[81] Simonson, T., Carlsson, J., and Case, D. A. Proton binding to proteins: pKa
calculations with explicit and implicit solvent models. J. Am. Chem. Soc. 126 (2004),
4167‚Äì4180.
[82] Alexov, E., Mehler, E. L., Baker, N., Baptista, A. M., Huang, Y., Milletti,
F., Nielsen, J. E., Farrell, D., Carstensen, T., Olsson, M. H. M., Shen, J. K.,
Warwicker, J., Williams, S., and Word, J. M. Progress in the prediction of pKa
values in proteins. Proteins 79 (2011), 3260‚Äì‚Äì3275.
[83] Allen, M., and Tildesley, D. Computer Simulations of Liquids. Clarendon Press,
Oxford, 1991.
[84] Frenkel, D., and Smit, B. Understanding molecular simulation. Academic Press, New
York, 1996.
[85] Pace, C. N., Grimsley, G. R., and Scholtz, J. M. Protein ionizable groups: pKa
values and their contribution to protein stability and solubility. J. Biol. Chem. 284 (2009),
13285‚Äì13289.
[86] Onufriev, A., Case, D. A., and Ullmann, M. A novel view of pH titration in
biomolecules. Biochemistry 40 (2001), 3413‚Äì3419.
[87] Wolfram, S. Mathematica. A system for doing mathematics by computer. Addison
Wesley, New York, 1991.
[88] Castaneda, C. A., Fitch, C. A., Majumdar, A., Khangulov, V., Schlessman,
J. L., and Garcia-Moreno, B. Molecular determinants of the pKa values of Asp and
Glu residues in Staphylococcal nuclease. Proteins 77 (2009), 570‚Äì‚Äì588.
[89] Giamonna, D. A. PhD thesis, University of California, Davis, 1984.

29

[90] Park, S., Yokoyama, T., Shibayama, N., Shiro, Y., and Tame, K. R. H. 1.25 aÃä
resolution crystal structures of human hemoglobin in the oxy, deoxy and carbonmonoxy
forms. J. Mol. Biol. 360 (2006), 690‚Äì701.
[91] Ho, C., and Yuan, Y. Haemoglobin: cooperativity in protein-ligand interactions. In
Encyclopedia of Life Sciences. John Willey and Sons, New York, 2010.
[92] Fang, T., Zou, M., Simplaceanu, V., Ho, N. T., and C., H. Assessment of roles of
surface histidyl residues in the molecular basis of the Bohr effect and of Œ≤143 histidine in
the binding of 2,3-bisphosphoglycerate in human normal adult hemoglobin. Biochemistry
38 (1999), 13423‚Äì13432.
[93] Mignon, D., Panel, N., Chen, X., Fuentes, E. J., and Simonson, T. Computational design of the tiam1 pdz domain and its ligand binding. J. Chem. Theory Comput.
13 (2017), 2271‚Äì2289.
[94] Mignon, D., and Simonson, T. Comparing three stochastic search algorithms for computational protein design: Monte Carlo, Replica Exchange Monte Carlo, and a multistart,
steepest-descent heuristic. J. Comput. Chem. 37 (2016), 1781‚Äì1793.
[95] Gough, J., Karplus, K., Hughey, R., and Chothia, C. Assignment of homology to
genome sequences using a library of hidden Markov models that represent all proteins of
known structure. J. Mol. Biol. 313 (2001), 903‚Äì919.
[96] Wilson, D., Madera, M., Vogel, C., Chothia, C., and Gough, J. The SUPERFAMILY database in 2007: families and functions. Nucl. Acids Res. 35 (2007),
D308‚Äì‚ÄìD313.
[97] Andreeva, A., Howorth, D., Brenner, S. E., Hubbard, J. J., Chothia, C., and
Murzin, A. G. SCOP database in 2004: refinements integrate structure and sequence
family data. Nucl. Acids Res. 32 (2004), D226‚Äì229.
[98] Bas, D. C., Rogers, D. M., and Jensen, J. H. Very fast prediction and rationalization
of pKa values for protein-ligand complexes. Proteins 73 (2008), 765‚Äì783.
[99] Olsson, T. S. G., Ladbury, J. E., Pitt, W. R., and Williams, M. A. Extent
of enthalpy-entropy compensation in protein-ligand interactions. Prot. Sci. 20 (2011),
1607‚Äì1618.

30

[100] Bashford, D., Case, D. A., Dalvit, C., Tennant, L., and Wright, P. Electrostatic calculations of side chain pKa values in myoglobin and comparison with NMR data
for histidines. Biochemistry 32 (1993), 8045‚Äì8056.
[101] Madera, M., Vogel, C., Kummerfeld, S. K., Chothia, C., and Gough, J. The
SUPERFAMILY database in 2004: additions and improvements. Nucl. Acids Res. 32
(2004), D235‚ÄìD239.
[102] Warwicker, J. Simplified methods for pKa and acid pH-dependent stability estimation
in proteins: removing dielectric and counterion boundaries. Prot. Sci. 8 (1999), 418‚Äì425.
[103] Simonson, T., and Brooks, C. L. Charge screening and the dielectric constant of
proteins: insights from molecular dynamics. J. Am. Chem. Soc. 118 (1996), 8452‚Äì8458.
[104] Simonson, T., Archontis, G., and Karplus, M. A Poisson-Boltzmann study of
charge insertion in an enzyme active site: the effect of dielectric relaxation. J. Phys.
Chem. B 103 (1999), 6142‚Äì6156.
[105] Archontis, G., and Simonson, T. Proton binding to proteins: a free energy component
analysis using a dielectric continuum model. Biophys. J. 88 (2005), 3888‚Äì3904.
[106] Simonson, T. What is the dielectric constant of a protein when its backbone is fixed? J.
Chem. Theory Comput. 9 (2013), 4603‚Äì4608.
[107] Srinivasan, J., Trevatan, M., Beroza, P., and Case, D. A. Application of a
pairwise Generalized Born model to proteins and nucleic acids: inclusion of salt effects.
Theor. Chem. Acc. 101 (1999), 426‚Äì434.
[108] Druart, K., Le Guennec, M., Palmai, Z., and Simonson, T. Probing the stereospecificity of tyrosyl- and glutaminyl-trna synthetase with molecular dynamics. J. Molec.
Graph. Model. 71 (2017), 192‚Äì199.
[109] Druart, K., Palmai, Z., Omarjee, E., and Simonson, T. Protein:ligand binding
free energies: a stringent test for computational protein design. J. Comput. Chem. 37
(2016), 404‚Äì415.
[110] Petukh, M., Stefl, S., and Alexov, E. The role of protonation states in ligandreceptor recognition and binding. Curr. Pharm. Design 19 (2013), 4182‚Äì4190.

31

Table 1: Acid/base test proteins

Protein
BPTI
OMTKY3
protein G
barnase
lysozyme
myoglobin
SNase
RNase H1
deoxy Hb
oxy Hb
Total
a
b

PDB
code
4pti
2gkr
1pga
1a2p
2lzt
1a6k
3bdc
1goa
2dn2
2dn3

number of
residues
58
56
56
110
129
151
141
155
287√ó2
287√ó2

titratable experimental
side chains
pKa ‚Äôs
12
12
13
13 (3)b
19
17 (4)
29
14 (1)
18
19
54
12 (2)
44
17 (2)
43
24 (3)
75√ó2
12
75√ó2
12
532
155 (15)b

a

computed
pKa ‚Äôs
12
13
16
14
18
11
17
24
12
12
149 (15)b

We exclude titratable side chains at the chain termini (6 side chains).

In parentheses: number of cases where only an upper or lower bound is available.

32

Table 2: Model compound protonation free energies ‚àÜGX
Protonation
reaction
‚àí

Asp
Glu‚àí
Tyr‚àí
Cys‚àí
Lys0
HisŒ¥
His

‚Üí AspH
‚Üí GluH
‚Üí TyrH
‚Üí CysH
‚Üí Lys+
‚Üí His+
‚Üí His+

Exp.
pKa

EX

EXH

3.9
4.3
9.8
8.6
10.4
6.5
7.0

-9.8
-7.2
-5.4
-11.4
6.3
21.5
20.7

-1.2
0.2
1.1
7.6
4.6
25.3
25.3

‚àÜEX

‚àíkT √ó
ln nnXH
X

conf
Œ¥gX

2.303 kT √ó
(pKaX ‚àí 7)

‚àÜGX
(pH = 7)

8.6
7.4
6.5
19.0
-1.7
3.8
4.6

-0.42
-0.42
-0.42
-0.66
0
0
0

0.12
0.07
0.08
-0.04
0
0
0

-4.28
-3.73
+3.87
+2.21
+4.70
-0.69
0.00

4.02
3.32
10.03
20.51
3.00
3.11
4.60

In kcal/mol. Individual terms are defined in Eq. (12). EX and EXH are from earlier work [22]. We set
kT to 0.6 kcal/mol.

33

Table 3: Unfolded state energies Eu (t) for CPD

Residues
ALA
CYS
THR
SER
ASP
GLU
ASN
GLN
a HIS+
a HIS

a HIS
Œ¥
ARG
LYS
ILE
VAL
LEU
MET
PHE
TRP
TYR

FDB
Buried Exposed

NEA
Buried Exposed

0.00
-1.06
-4.84
-4.45
-14.55
-14.52
-14.02
-13.14
12.86
10.85
10.41
-51.37
-8.24
5.50
-0.05
0.00
-2.85
0.17
-1.94
-5.91

0.00
-0.89
-5.31
-5.55
-17.26
-16.12
-16.38
-14.00
11.21
10.63
15.17
-53.40
-8.20
6.76
0.43
0.52
-1.61
1.86
-0.23
-5.10

0.00
-1.64
-6.68
-5.24
-18.82
-18.21
-17.80
-16.61
10.98
8.12
7.37
-54.76
-11.35
3.06
-1.66
-2.94
-3.09
-3.18
-5.53
-10.14

0.00
-2.57
-8.07
-6.55
-22.06
-20.68
-20.41
-18.41
10.72
6.95
6.15
-57.36
-12.34
3.44
-2.19
-3.72
-3.21
-2.68
-7.67
-10.90

Unfolded state energies Eu (t) (kcal/mol) for each amino acid type t, optimized with NEA or FDB; there
are distinct values for positions that are buried or exposed (in the folded structure). Calculations were
done with a protein dielectric constant of four and the following surface energy coefficients (cal/mol/AÃä2 ):
-60 (hydrophobic), 30 (aromatic), -120 (polar), -110 (ionic). Buried positions are those with a fractional
solvent accessible surface area of less than 0.30; other positions are exposed. a His protonation states.

34

Table 4: Deviation between experimental and computed pKa ‚Äôs per protein

Protein

number
of pKa ‚Äôs

NEA
max(position)a

NEA
rmsd

FDB
rmsd

FDB
mueb

FDB
max(position)a

PropKa
rmsdc

BPTI
OMTKY3
protein G
barnase
lysozyme
myoglobin
SNase
RNase H1
deoxy Hb
oxy Hb

12
13
16
14
18
11
17
24
12
12

-1.6 (Y35)
-2.4 (K29)
-1.8 (D47)
2.5 (D101)
-3.4 (D66)
1.7 (Y146)
2.7 (D19)
3.0 (D148)
2.1 (HŒ≤117)
1.9 (HŒ≤116)

0.8
1.1
0.8
1.1
1.4
0.9
1.5
1.5
0.9
1.1

0.8
0.9
0.8
1.0
1.1
1.1
1.3
1.4
0.7
0.8

0.6
0.7
0.5
0.8
0.8
0.9
1.1
1.0
0.5
0.6

-2.5 (Y35)
-1.8 (Y31)
-2.0 (D47)
2.0 (D101)
-2.8 (E35)
2.1 (Y103)
-2.3 (E135)
-2.6(H114,D134)
1.1 (HŒ≤1
1.8 (HŒ≤11

0.4
0.6
0.6
1.2
0.5
0.8
1.3
0.8

All

149

1.0

0.8

a

1.2
b

0.8
c

Maximum error and corresponding residue(s). Mean unsigned error. From earlier work [22].

Table 5: Deviation between experimental and computed pKa ‚Äôs per residue class
number
of pKa ‚Äôs
Asp
38
Glu
37
His
41
Lys
17
Tyr
15
shift<1
95
1‚â§shift<2
32
2‚â§shift
7
a

rmsd
NEA
1.3
1.4
0.9
1.0
0.8
1.1
1.1
1.8

rmsd
FDB PropKaa
1.2
0.9
1.2
0.9
0.7
1.0
0.8
0.6
1.2
0.6
1.0
0.6
1.0
1.0
1.6
1.5

From earlier work [22].

35

Table 6: pKa shifts for histidines in oxy/deoxy hemoglobin

Exp.
Exp.
Residue pKa
shift
Œ± 20
7.02
0.52
Œ± 45
5.25
-1.25
Œ± 50
7.14
0.64
Œ± 58
Œ± 72
7.47
0.97
Œ± 89
6.80
0.30
Œ± 103
Œ± 112
7.49
0.99
Œ± 122
Œ≤2
6.17
-0.33
Œ≤ 63
Œ≤ 77
7.46
0.96
Œ≤ 97
8.01
1.51
Œ≤ 116
6.35
-0.15
Œ≤ 117
6.43
-0.07
Œ≤ 143
4.70
-1.80
Œ≤ 146
7.93
1.43
Œ±
rms deviations:
Œ≤
rms deviations:
a

deoxy
NEA
shift
1.25[0.7]a

FDB
shift
0.88[0.4]a

1.00[0.4]
0.88
1.67[0.7]
0.75[0.5]
1.62
1.00[0.1]
-0.50
-0.25[0.1]
1.25
1.88[0.9]
1.38[0.1]
1.00[1.1]
2.00[2.1]
-0.75[1.0]
1.25[0.2]
0.5
1.0

0.62[0.1]
1.58
1.5[0.5]
0.94[0.6]
1.62
1.25[0.3]
-1.34
-0.50[0.2]
1.88
1.75[0.8]
1.75[0.2]
1.00[1.1]
1.44[1.5]
-1.25[0.6]
1.25[0.2]
0.4
0.8

Values in brackets are unsigned errors.

36

Exp.
pKa
7.08
6.12
6.90

Exp.
shift
0.58
-0.38
0.40

7.27
6.25

0.77
-0.25

7.53

1.03

6.39

-0.11

7.79
7.75
6.13
6.39
5.57
6.42

1.29
1.25
-0.37
-0.11
-0.93
-0.08

oxy
NEA
shift
1.00[0.4]a

FDB
shift
0.75[0.2]a

0.50[0.1]

0.00[0.4]

1.83[1.0]
0.12[0.4]
0.62
0.62[0.5]
-0.12
0.62[0.7]

1.50[0.7]
0.16[0.4]
0.75
1.00[0.0]
-1.12
0.42[0.5]

1.88[0.6]
1.31[0.1]
1.62[1.9]
1.16[1.3]
-1.25[0.3]
-1.25[1.7]
0.8
1.0

1.75[0.5]
1.75[0.5]
1.75[2.1]
1.00[1.1]
-1.25[0.3]
-0.38[0.3]
0.5
0.8

Table 7: Bohr effect contributions from individual residues

Residue
Œ≤H143
Œ≤H116
Œ≤H2
Œ≤H117
Œ±H89
Œ±H50
Œ±H20
Œ≤H146
Œ±H72
Œ±H112
Œ≤H77
Œ≤H97

Experiment
pH protons
5.1
-0.93
6.2
0.26
6.3
-0.25
6.4
0.05
6.5
0.61
7.0
0.27
7.1
-0.07
7.2
1.40
7.4
0.23
7.5
-0.05
7.6
-0.37
7.8
0.30

FDB
pH protons
5.2
0.36
8.0
-1.04
6.5
-0.89
7.8
0.93
7.0
0.65
6.8
0.56
7.4
0.29
7.0
1.64
8.0
0.00
7.6
0.29
8.9
-0.05
7.9
0.29

37

pH
5.5
7.8
6.7
8.1
6.9
7.3
7.6
6.6
8.3
7.3
8.4
7.8

NEA
protons
0.56
-0.68
-0.93
0.90
0.69
0.56
0.29
1.84
-0.18
0.43
0.00
0.08

Table 8: Fold recognition of designed sequences by Superfamily

Design
Protein
model
NHERF Proteus, NEA
syntenin Proteus, NEA
DLG2 Proteus, NEA
NHERF Proteus, FDB
syntenin Proteus, FDB
DLG2
Proteus, FDB
NHERF
Rosetta
syntenin
Rosetta
DLG2
Rosetta
a
b

a

Match/seq
length
62/91
70/82
83/97
80/91
70/82
88/97
79/91
76/82
86/97

b

Superfamily
E-value
3.2e-3
2.8e-3
1.7e-3
8.5e-14
2.8e-6
3.3e-12
1.3e-13
7.3e-13
1.3e-9

c

Superfamily
success #
9857
9879
9876
10000
10000
10000
10000
10000
10000

b

Family
E-value
1.0e-2
3.6e-3
3.2e-3
8.9e-3
2.7e-3
2.0e-3
2.2e-3
1.8e-3
9.6e-4

c

Family
success #
9857
9879
9876
10000
10000
10000
10000
10000
10000

The average match length for sequences recognized by Superfamily and the total sequence length.

Average E-values for Superfamily assignments to the correct SCOP superfamily/family.

c

The num-

ber of designed sequences (out of 10000 tested) assigned to the correct SCOP superfamily/family.

38

Diagonal matrix elements
Residue Residue Rotamer number
number I name

GBNEA

Eref vdW elec ASA Q2

GBself

FDB fitting coefficients

1141 ARG R 38 -45.24 24.56 -46.33 0.26 3.35 -72.60 39.89 -12.10 0.10 -3.7E-04 249.16 -30.19
:
:
2001 VAL V 1 0.17 4.17 -2.55 0.15 0.33 -5.97
Eref vdW elec ASA Q2 GB
self

Off-diagonal matrix elements
Residue numbers I, J

GBself

GBNEA

FDB fitting coefficients

2035 TYD 1122 HIP
8 1 -2.1E-02 2.7E-02 0 3.0E-02 8.5E-03 0.28 0.29 -2.8E-03 9.5E-06 4.7E-03 -2.0E-02
vdW elec ASA
:
:
:
2035 TYD 2028 LEU
11 1 -0.177 0.16 4.4E-02
vdW elec
ASA
Rotamer numbers

Figure 1: Energy matrix elements. For diagonal elements (above), we show an
example of an FDB element and an NEA element (one rotamer each). The individual
energy components are labelled. ASA labels the surface energy term. Although the
Arg1141 position is treated with FDB, the matrix includes the NEA estimate of the GB
P
contribution. The quantity labeled Q2 is the total squared charge i‚ààI qi2 , needed to
compute the solvation radius BI (Eq. 6). The five rightmost quantities are the fitting
coefficients cII
n (Eq. 8). For off-diagonal elements (below), we also show an FDB
and an NEA pair (one rotamer combination each). For the FDB pair, the GB self-energy
self
self
contributions EIJ
and EJI
(Eq. 3) are both stored (the GB self energy is non-symmetric).

39

Computed pKa shift

4

NEA
FDB

2

0

-2

Œµp = 4

-4
-4

-2

0

2

4

Experimental pKa shift
Figure 2: Comparison between computed and experimental pKa shifts. Each dot corresponds to one titratable position in one of the test proteins. Black (respectively, grey) dots
correspond to FDB (NEA) computations. pKa shifts are relative to the corresponding
model compound pKa ‚Äôs. Dashed lines are one unit above/below the main diagonal.

40

protonation probability

1
0.75
0.5

D7

E19
D27

E43

H52

Y31
K34 K13
Y20

E10

0.25

Y11
K55

K29

0

2

4

6

8

10

12

14

pH
SUM

1

H24
H119

number of protons

0.8

0.6
MEAN

0.4

0.2

0

2

4

6

8

10

12

pH
Figure 3: Above: OMTKY3 Titration curves. Below: titration of a coupled histidine pair
in myoglobin (FDB results). The pair binds one proton at low pH. ‚ÄúMEAN‚Äù indicates
the mean number of protons per histidine (0.5 at low pH).

41

Computed pKa shift

2

Œµp = 4

0

NEA
FDB

-2
-2

0

2

Experimental pKa shift
Figure 4: Comparison between computed and experimental pKa shifts for hemoglobin.

42

FDB

2.5

Number of protons

2
1.5

H146
FDB

NEA

1
0.5
0
-0.5
-1

EXP
3

4

5

6

7

8

9

10

pH
Figure 5: Bohr effect in hemoglobin due to histidine residues (excluding H45; see text).
Both FDB and NEA predictions are shown. The separate contribution of Œ≤His146 is
shown.

43

Figure 6: Histogram plots showing Blosum similarity scores for designed PDZ sequences. Similarity scores for the entire protein (left) or 14 core positions (right). Values are shown for
Proteus(NEA), Proteus(FDB), Rosetta, and Pfam sequences (all compared to the Pfam RP55
alignment).

44

